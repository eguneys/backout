var Tetris=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){n(2);const r=n(3);e.exports=r.app},function(e,t,n){},function(e,t,n){"use strict";n.r(t);const r={Play:"play",Over:"over"},a=3,s=4,i=Math.PI,o=2*i,h=o/3;function c(e,t){return Math.random()*(t-e)+e}function l(e,t,n){return Math.min(Math.max(e,t),n)}function d(){return Date.now()}const u=(e,t,n=1e3)=>{d()-e>n&&t()};function f(e,t){const{width:n,height:r}=e.game,a=n*r;this.buffers={Screen:0,Effects:a,Buffer:2*a,Background:3*a,Midground:4*a,Foreground:5*a,Sprites:7*a,Ui:8*a,Collision:9*a};const s=this.buffers,i=[4278715910,4279439380,4280620859,4281145203,4280950964,4280499935,4278872826,4280001529,4282504703,4282449151,4284805846,4282637212,4281712985,4281245716,4282284570,4282077732,4280295442,4284757012,4291058728,4292779812,4291286560,4292607142,4294967295,4290835454,4290303738,4288127221,4285754088,4288367292,4286593657,4283642688,4281606692,4279901218,4280822578,4282073457,4282873275,4284720347,4288467700,4293583066,4291934643,4289696651,4287460717,4284634186,4282464563,4281541698,4281872731,4283585166,4285167034,4288919017,4294960867,4294688697,4293172100,4290678104,4286938439,4283328291,4284777522,4287475549,4290436242,4293064653,4289385188,4287344839,4284647072,4283787129,4282666586,4281612610,4278190080];let o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64];this.renderTarget=s.Screen,this.renderSource=s.Page1;const h=t.getImageData(0,0,n,r);let c=new ArrayBuffer(h.data.length),d=new Uint8ClampedArray(c),u=new Uint32Array(c),f=new Uint8ClampedArray(n*r*22);this.clear=e=>{f.fill(e,this.renderTarget,this.renderTarget+a)},this.pset=(e,t,a)=>{e=l(0|e,0,n),t=l(0|t,0,r),f[this.renderTarget+t*n+e]=a},this.pget=(e,t,a)=>(e=l(0|e,0,n),t=l(0|t,0,r),f[a+t*n+e]),this.spr=(e=0,t=0,a=n,s=r,i=0,h=0,c=!1,l=!1)=>{for(let d=0;d<s;d++)for(let s=0;s<a;s++)if(h+d<r&&i+s<n&&h+d>-1&&i+s>-1&&!c&!l){let r=this.renderTarget+((h+d)*n+i+s),a=this.renderSource+((t+d)*n+e+s);f[a]>0&&(f[r]=o[f[a]])}},this.rspr=(e,t,a,s,i,h,c,l)=>{let d=a/2|0,u=s/2|0,p=a/2*1.41421|5,g=s/2*1.41421|5,y=-p,v=p,x=-g,w=g,b=Math.cos(-l),m=Math.sin(-l);for(let c=x;c<w;c++)for(let l=y;l<v;l++){let p=d+Math.round(b*l+m*c),g=u+Math.round(-m*l+b*c),y=l+i|0,v=c+h|0;if(y>0&&y<n&&v>0&&v<r&&p>=0&&g>=0&&p<a&&g<s){let r=this.renderSource+(p+e)+(g+t)*n,a=this.renderTarget+y+v*n;f[r]>0&&(f[a]=o[f[r]])}}},this.line=(e,t,n,r,a)=>{let s,i=(r|=0)-(t|=0),o=(n|=0)-(e|=0),h=1,c=1;if(i<0&&(i=-i,c=-1),o<0&&(o=-o,h=-1),i<<=1,o<<=1,this.pset(e,t,a),o>i)for(s=i-(o>>1);e!=n;)s>=0&&(t+=c,s-=o),e+=h,s+=i,this.pset(e,t,a);else for(s=o-(i>>1);t!=r;)s>=0&&(e+=h,s-=i),t+=c,s+=o,this.pset(e,t,a)},this.circle=(e,t,n,r)=>{let a=-n,s=0,i=2-2*n;do{this.pset(e-a,t+s,r),this.pset(e-s,t-a,r),this.pset(e+a,t-s,r),this.pset(e+s,t+a,r),(n=i)<=s&&(i+=2*++s+1),(n>a||i>s)&&(i+=2*++a+1)}while(a<0)},this.fillCircle=(e,t,n,r)=>{if(n<0)return;e|=0,t|=0,r|=0;let a=-(n|=0),s=0,i=2-2*n;do{this.line(e-a,t-s,e+a,t-s,r),this.line(e-a,t+s,e+a,t+s,r),(n=i)<=s&&(i+=2*++s+1),(n>a||i>s)&&(i+=2*++a+1)}while(a<0)},this.fillRect=(e,t,n,r,a)=>{e|=0,t|=0,n|=0,r|=0;let s=Math.abs(r-t);if(this.line(e,t,n,t,a),s>0)for(;--s;)this.line(e,t+s,n,t+s,a);this.line(e,r,n,r,a)},this.fr=(e,t,n,r,a)=>{let s=0|e,i=0|t,o=e+n|0,h=t+r|0,c=Math.abs(h-i);if(this.line(s,i,o,i,a),c>0)for(;--c;)this.line(s,i+c,o,i+c,a);this.line(s,h,o,h,a)};this.render=()=>{let e=s.Effects;for(;e--;)u[e]=i[o[f[e]]];h.data.set(d),t.putImageData(h,0,0)}}const p=function(){const e={0:"\n.....\n.   .\n. . .\n.   .\n.....\n",1:"\n ..\n. .\n  .\n  .\n....\n",2:"\n ...\n.  .\n  .\n . \n....\n",3:"\n ...\n.  .\n  .\n   .\n....\n",4:"\n   .\n  ..\n . .\n.....\n   .\n   .\n",5:"\n....\n. \n....\n   .\n....\n",6:"\n.....\n.\n.....\n.   .\n.....\n",7:"\n.....\n    .\n    .\n    .\n    .\n",8:"\n.....\n.   .\n.....\n.   .\n.....\n",9:"\n.....\n.   .\n.....\n    .\n.....\n","-":"\n\n\n.....\n\n\n",".":"\n\n\n\n\n .\n"," ":"\n\n\n\n\n\n","/":"\n    .\n   .\n  .\n .\n.\n",a:"\n  .\n . .\n.   .\n.....\n.   .\n",b:"\n....\n.   .\n....\n.   .\n....\n",c:"\n  ...\n.\n.\n.\n ....\n",d:"\n....\n.   .\n.   .\n.   .\n....\n",e:"\n ....\n.\n....\n.\n.....\n",f:"\n ....\n.\n....\n.\n.\n",g:"\n.....\n.\n. ...\n.   .\n.....\n",h:"\n.   .\n.   .\n.....\n.   .\n.   .\n",k:"\n.  .\n. .\n..\n. .\n.  .\n",i:"\n.....\n  .\n  .\n  .\n.....\n",l:"\n.\n.\n.\n.\n.....\n",n:"\n.   .\n..  .\n. . .\n.  ..\n.   .\n",p:"\n....\n.   .\n....\n.\n.\n",r:"\n....\n.   .\n....\n.   .\n.   .\n",s:"\n ...\n.   \n ..\n   .\n...\n",t:"\n.....\n  .\n  .\n  .\n  .\n",u:"\n.   .\n.   .\n.   .\n.   .\n ...\n",v:"\n.   .\n.   .\n.   .\n . .\n  .\n",w:"\n.   .\n.   .\n. . .\n. . .\n . .\n",x:"\n.   .\n . .\n  .\n . .\n.   .\n",y:"\n.   .\n . .\n  .\n  .\n  .\n",unknown:"\n.....\n.   .\n.   .\n.   .\n.....\n"};return Object.keys(e).reduce((t,n)=>({[n]:e[n].replace(/^\n|\n$/g,"").split("\n").map(e=>e.split("")),...t}),{})}();function g(e,t){let n=e.text.length;for(let r=0;r<n;r++){let n=p[e.text.charAt(r)]||p.unknown;for(let a=0;a<5;a++)for(let s=0;s<5;s++)"."===n[a][s]&&(1===e.scale?t.pset(e.x+s+(5+e.hspacing)*r,e.y+a,e.color):t.fr(e.x+s*e.scale+(5*e.scale+e.hspacing)*r,e.y+a*e.scale,e.scale,e.scale,e.color))}}function y(e,t){let n=5*(e={scale:1,hspacing:2,vspacing:2,halign:"center",valign:"center",render:!0,...e}).scale,r=e.text.split("\n"),a=r.slice(0),s=r.length,i=a.sort((e,t)=>t.length-e.length)[0],o=i.length*n+(i.length-1)*e.hspacing,h=s*n+(s-1)*e.vspacing,c=e.x,l=e.y,d=e.x+o,u=e.y+h;"center"===e.halign&&(c=e.x-o/2,d=e.x+o/2),"center"===e.valign&&(l=e.y-h/2,u=e.y+h/2);let f=c+o/2,p=l+h/2;if(e.render)for(let a=0;a<s;a++){let s=r[a],i=s.length*n+(s.length-1)*e.hspacing,o=e.x,c=e.y+(n+e.vspacing)*a;"center"===e.halign&&(o=e.x-i/2),"center"===e.valign&&(c-=h/2),g({x:o,y:c,text:s,hspacing:e.hspacing||0,scale:e.scale||1,color:e.color},t)}return{sx:c,sy:l,cx:f,cy:p,ex:d,ey:u,width:o,height:h}}function v(e,t){const{width:n,height:a}=e.data.game,s=t.buffers,i=e=>{const r=e.data.game.score+"";(e=>{const r=.01*e.data.game.tick,s=.6*n,i=.3*a,o=.008*s,h=n/2-s/2,c=.2*a-i/2;let l=Math.sin(r)*o;t.fr(h+3*o,c+3*o-Math.sin(r)*o,s,i,41),t.fr(h+l,c,s,i,50),y({x:n/2+l,y:.2*a,text:"backout",color:1,scale:5},t)})(e);let s,i=.1*a;s=y({x:n/2,y:.45*a,text:"high score "+r,color:12,scale:3,render:e.data.gameover},t),s=y({x:n/2,y:s.ey+i,text:"press space to play.",color:5,scale:2},t),y({x:n/2,y:s.ey+2*i,text:"avoid paddles to hit the ball.\nuse arrow keys to control paddles.\nuse space to go faster.",vspacing:8,color:7,scale:1.8},t)};this.render=e=>{t.renderTarget=s.Ui,e.data.state===r.Over&&i(e)}}function x(e,t){const{width:n,height:r}=e.data.game,a=t.buffers;this.render=e=>{(function(e,t){const s=e.data.hero.edge,i="left"===s?38:41,o="right"===s?38:41,h="up"===s?38:41,c="down"===s?38:41;t.renderTarget=a.Screen,t.line(0,0,n,0,h),t.line(0,0,0,r,i),t.line(0,r-1,n,r-1,c),t.line(n-1,0,n-1,r,o)})(e=e.play,t),e.data.paddles.forEach(e=>(function(e,t,s){s.renderTarget=a.Collision;const{x:i,y:o,w:h,h:c,side:l}=t,{vx:d,vy:u}=t,f=1===d||1===u?12:15;let p=0,g=0;switch(l){case"left":p=.08*c,g=.03*(r/2-o);break;case"right":p=.08*-c,g=.03*(r/2-o);break;case"up":g=.08*h,p=.01*(n/2-i);break;case"down":g=.08*-h,p=.01*(n/2-i)}s.fr(i+p,o+g,h,c,16),s.fr(i+p,o+g,h,c,16),s.fr(i,o,h,c,f)})(0,e,t)),e.blocks.each(e=>(function(e,t){t.renderTarget=a.Collision;const{x:n,y:r,angle:s,length:i,color:o}=e.data;let h=Math.cos(s)*i,c=Math.sin(s)*i;t.line(n,r,n+h,r+c,o)})(e,t)),function(e,t){t.renderTarget=a.Collision;const{vx:n,vy:r,x:s,y:i,radius:o,color:h,active:c}=e.data.hero;t.fillCircle(s,i,o,h),t.renderTarget=a.Midground;const l=[42,41,40,39,38],d=l[Math.floor(c)%l.length];t.fillCircle(s,i,o,d)}(e,t),function(e,t){const r=e.data.game.score+"",a=y({x:.1*n,y:10,text:"score",color:48,scale:1},t);y({x:a.ex+20,y:10,text:r,color:48,scale:1},t)}(e,t)}}function w(e,t){const{width:n,height:r}=e.data.game,a=t.buffers;t.renderTarget=a.Screen;const s=new v(e,t),i=new x(e,t);this.render=e=>{!function(e,t){t.renderTarget=a.Ui,t.clear(0),t.renderTarget=a.Collision,t.clear(0),t.renderTarget=a.Screen,t.clear(0),t.renderTarget=a.Midground,t.clear(0)}(0,t),i.render(e),s.render(e),function(e,t){if(!e.data.debug)return;t.renderTarget=a.Foreground;for(let e=0;e<64;e++){const r=8*Math.floor(e/32)*4+.2*n,a=e%32*8;t.fillRect(r,a,r+8,a+8,e),y({x:r-8,y:a,hspacing:1,text:e+"",color:e},t)}}(e,t),function(e,t){t.renderSource=a.Collision,t.renderTarget=a.Screen,t.spr(),t.renderSource=a.Ui,t.renderTarget=a.Screen,t.spr(),t.renderSource=a.Midground,t.renderTarget=a.Screen,t.spr(),t.renderSource=a.Foreground,t.renderTarget=a.Screen,t.spr()}(0,t)}}function b(e,t){this.alive=[],this.dead=[],this.create=n=>{if(this.dead.length>0){let e=this.dead.pop();return e.init(n),this.alive.push(e),e}{let r=new e(t);return r.init(n),this.alive.push(r),r}},this.release=e=>{let t=this.alive.indexOf(e);t>-1&&this.dead.push(this.alive.splice(t,1)[0])},this.each=e=>{this.alive.forEach(e)},this.find=e=>this.alive.find(e)}function m(e){const{width:t,height:n}=e.data.game,r=e.data.hero;this.update=e=>{(e=>{r.vx+=r.ax*e*.001*r.boost,r.vy+=r.ay*e*.001*r.boost,r.x+=r.vx,r.y+=r.vy,r.x<0&&(r.x=0,r.vx*=-.5,r.ax*=-1,r.edge="left",r.active=4),r.y<0&&(r.y=0,r.vy*=-.5,r.ay*=-1,r.edge="up",r.active=4),r.x>=t&&(r.x=t,r.vx*=-.5,r.ax*=-1,r.edge="right",r.active=4),r.y>=n&&(r.y=n,r.vy*=-.5,r.ay*=-1,r.edge="down",r.active=4)})(e),(e=>{r.tick+=e,r.active>0&&(r.active=Math.max(0,r.active-e/16*.2))})(e)},this.boost=e=>{r.boost=e},this.changeV=e=>{const t=[Math.cos(e),Math.sin(e)],n=[-r.vx,-r.vy],a=[n[0]+t[0],n[1]+t[1]];r.vx=l(2*a[0],-1,1),r.vy=l(2*a[1],-1,1),r.ax=l(2*a[0],-1,1),r.ay=l(2*a[1],-1,1),r.active=4}}function M(e,t,n){return n((n,r)=>e.pget(n,r,e.buffers.Collision)===t)}function k({x:e,y:t,w:n,h:r}){return a=>{for(let s=0;s<n;s+=1)for(let n=0;n<r;n+=1){if(a(e+s,t+n))return{x:s,y:n}}return null}}function T(e,t){const{width:n,height:r}=e.data.game,s=e.data.paddles;this.update=i=>{(n=>{s.map(e=>({e:e,c:M(t,a,k(e))})).find(e=>!!e.c)&&e.paddleHit()})(),s.forEach(t=>(t=>a=>{t.x+=t.vx*e.data.paddleBoost[0],t.y+=t.vy*e.data.paddleBoost[1],t.x>n-t.w&&(t.x=n-t.w,t.vx*=-1),t.x<0&&(t.x=0,t.vx*=-1),t.y>r-t.h&&(t.y=r-t.h,t.vy*=-1),t.y<0&&(t.y=0,t.vy*=-1)})(t)(i))}}function S(e,t){this.data=e;const{width:n,height:s}=this.data.game;this.hero=new m(this),this.paddles=new T(this,t),this.blocks=new b(B,this);const i=e=>{const n=this.blocks.find(e=>!(e.life<100)&&M(t,a,function({x:e,y:t,angle:n,length:r}){return a=>{for(let s=0;s<r;s+=.1){const r=Math.cos(n)*s,i=Math.sin(n)*s;let o=e+r,h=t+i;if(a(o,h))return{x:o,y:h}}return null}}(e.data)));n&&h(n)},h=e=>{const{angle:t}=e.data;this.hero.changeV(t),this.blocks.release(e),this.data.game.score++},l=()=>{this.userBoost?(this.hero.boost(20),u(this.userBoost,()=>{this.userBoost=0},100)):this.hero.boost(1)},f=O(()=>{const e=this.data.game.unit;this.blocks.create({x:c(e,n-e),y:c(e,s-e),length:.4*e,angle:c(0,o/4-o/8)+o/10})},1e3);this.reset=()=>{this.data.hero.x=n/2,this.data.hero.y=s/2,this.data.game.score=0},this.boost=()=>{this.userBoost=d()},this.paddleHit=()=>{this.data.gameover=d(),this.data.state=r.Over},this.paddleMove=e=>{0===e[0]?this.data.paddleBoost[0]=1:this.data.paddleBoost[0]=2*e[0],0===e[1]?this.data.paddleBoost[1]=1:this.data.paddleBoost[1]=2*e[1]},this.update=e=>{l(),f(e),i(),this.hero.update(e),this.paddles.update(e),this.blocks.each(t=>t.update(e))}}function B(e){this.init=e=>{this.data={...t(),...e},this.life=0},this.update=e=>{this.life+=e};const t=()=>({x:0,y:0,angle:h,length:100,color:s})}const O=(e,t,n)=>{let r=0;return a=>{(r+=a)>=t?(e(),r=0):n&&n(r/t)}};function C(e,t){this.data=e,this.update=e=>{}}function P(e,t){this.data=e,this.play=new S(e,t),this.over=new C(e,t);const n=e=>{this.data.state===r.Play&&this.play.update(e),this.shouldResetGame&&(this.shouldResetGame=!1,this.play.reset(),this.data.gameover=0,this.data.state=r.Play)},a=e=>{this.data.state===r.Over&&this.over.update(e)};this.spaceHit=()=>{this.data.state===r.Play?this.play.boost():this.data.gameover?u(this.data.gameover,()=>{this.shouldResetGame=!0}):this.shouldResetGame=!0},this.pressKey=e=>{switch(e){case"up":this.play.paddleMove([0,-1]);break;case"down":this.play.paddleMove([0,1]);break;case"left":this.play.paddleMove([-1,0]);break;case"right":this.play.paddleMove([1,0])}},this.update=e=>{n(e),a(e),this.data.game.tick+=e}}const A=void 0!==window.performance?window.performance:Date,j=()=>A.now(),E=window.requestAnimationFrame;function U(e){let t=!1,n=j(),r=0;this.start=()=>t?this:(t=!0,n=j(),r=E(a),this),this.stop=()=>(t=!1,0!=r&&E.cancel(r),r=0,this);const a=()=>{r=E(a);const t=j();e(t-n),n=t}}function R(e,t){const n=document.createElement("canvas"),s=n.getContext("2d"),i={debug:!1,state:r.Over,game:{score:0,unit:40,width:384,height:256,ratio:256/384,vx:10,tick:0},paddleBoost:[1,1],paddles:[{side:"up",vx:1,vy:0,x:192,y:1,w:40,h:10},{side:"down",vx:-1,vy:0,x:192,y:245,w:40,h:10},{side:"left",vx:0,vy:1,x:1,y:128,w:10,h:40},{side:"right",vx:0,vy:-1,x:373,y:128,w:10,h:40}],hero:{color:a,radius:5,gap:2,gapMove:2,rotation:0,x:192,y:128,ax:0,ay:-1,vx:0,vy:0,boost:1,tick:0,active:0}};let o=new f(i,s),h=new P(i,o),c=new w(h,o);new U(e=>{h.update(e),c.render(h),o.render()}).start(),n.width=i.game.width,n.height=i.game.height,e.append(n),function(e){const t=[],n=function(e){return function(t){switch(t.code){case"Space":e.spaceHit();break;case"ArrowUp":e.pressKey("up");break;case"ArrowDown":e.pressKey("down");break;case"ArrowLeft":e.pressKey("left");break;case"ArrowRight":e.pressKey("right");break;default:return}t.preventDefault()}}(e);var r,a,s;t.push((r=document,a="keydown",s=n,r.addEventListener(a,s),()=>r.removeEventListener(a,s)))}(h)}n.d(t,"app",function(){return R})}]);