var Tetris=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){n(2);const i=n(3);t.exports=i.app},function(t,e,n){},function(t,e,n){"use strict";n.r(e);const i=3,r=4,s=Math.PI,o=2*s,a=o/3;function c(t,e){return Math.random()*(e-t)+t}function h(t,e,n){return Math.min(Math.max(t,e),n)}function l(t,e){const{width:n,height:i}=t.game,r=n*i;this.buffers={Screen:0,Effects:r,Buffer:2*r,Background:3*r,Midground:4*r,Foreground:5*r,Sprites:7*r,Ui:8*r,Collision:9*r};const s=this.buffers,o=[4278715910,4279439380,4280620859,4281145203,4280950964,4280499935,4278872826,4280001529,4282504703,4282449151,4284805846,4282637212,4281712985,4281245716,4282284570,4282077732,4280295442,4284757012,4291058728,4292779812,4291286560,4292607142,4294967295,4290835454,4290303738,4288127221,4285754088,4288367292,4286593657,4283642688,4281606692,4279901218,4280822578,4282073457,4282873275,4284720347,4288467700,4293583066,4291934643,4289696651,4287460717,4284634186,4282464563,4281541698,4281872731,4283585166,4285167034,4288919017,4294960867,4294688697,4293172100,4290678104,4286938439,4283328291,4284777522,4287475549,4290436242,4293064653,4289385188,4287344839,4284647072,4283787129,4282666586,4281612610,4278190080];let a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64];this.renderTarget=s.Screen,this.renderSource=s.Page1;const c=e.getImageData(0,0,n,i);let l=new ArrayBuffer(c.data.length),u=new Uint8ClampedArray(l),d=new Uint32Array(l),f=new Uint8ClampedArray(n*i*22);this.clear=t=>{f.fill(t,this.renderTarget,this.renderTarget+r)},this.pset=(t,e,r)=>{t=h(0|t,0,n),e=h(0|e,0,i),f[this.renderTarget+e*n+t]=r},this.pget=(t,e,r)=>(t=h(0|t,0,n),e=h(0|e,0,i),f[r+e*n+t]),this.spr=(t=0,e=0,r=n,s=i,o=0,c=0,h=!1,l=!1)=>{for(let u=0;u<s;u++)for(let s=0;s<r;s++)if(c+u<i&&o+s<n&&c+u>-1&&o+s>-1&&!h&!l){let i=this.renderTarget+((c+u)*n+o+s),r=this.renderSource+((e+u)*n+t+s);f[r]>0&&(f[i]=a[f[r]])}},this.line=(t,e,n,i,r)=>{let s,o=(i|=0)-(e|=0),a=(n|=0)-(t|=0),c=1,h=1;if(o<0&&(o=-o,h=-1),a<0&&(a=-a,c=-1),o<<=1,a<<=1,this.pset(t,e,r),a>o)for(s=o-(a>>1);t!=n;)s>=0&&(e+=h,s-=a),t+=c,s+=o,this.pset(t,e,r);else for(s=a-(o>>1);e!=i;)s>=0&&(t+=c,s-=o),e+=h,s+=a,this.pset(t,e,r)},this.circle=(t,e,n,i)=>{let r=-n,s=0,o=2-2*n;do{this.pset(t-r,e+s,i),this.pset(t-s,e-r,i),this.pset(t+r,e-s,i),this.pset(t+s,e+r,i),(n=o)<=s&&(o+=2*++s+1),(n>r||o>s)&&(o+=2*++r+1)}while(r<0)},this.fillCircle=(t,e,n,i)=>{if(n<0)return;t|=0,e|=0,i|=0;let r=-(n|=0),s=0,o=2-2*n;do{this.line(t-r,e-s,t+r,e-s,i),this.line(t-r,e+s,t+r,e+s,i),(n=o)<=s&&(o+=2*++s+1),(n>r||o>s)&&(o+=2*++r+1)}while(r<0)};this.fr=(t,e,n,i,r)=>{let s=0|t,o=0|e,a=t+n|0,c=e+i|0,h=Math.abs(c-o);if(this.line(s,o,a,o,r),h>0)for(;--h;)this.line(s,o+h,a,o+h,r);this.line(s,c,a,c,r)};this.render=()=>{let t=65536;for(;t--;)d[t]=o[a[f[t]]];c.data.set(u),e.putImageData(c,0,0)}}!function(){const t={"-":"\n\n\n.....\n\n\n"," ":"\n\n\n\n\n\n","/":"\n    .\n   .\n  .\n .\n.\n",x:"\n.   .\n . .\n  .\n . .\n.   .\n",unknown:"\n.....\n.   .\n.   .\n.   .\n.....\n"};Object.keys(t).reduce((e,n)=>({[n]:t[n].replace(/^\n|\n$/g,"").split("\n").map(t=>t.split("")),...e}),{})}();function u(t,e){const{width:n,height:i}=t.data.game,r=e.buffers;e.renderTarget=r.Screen,this.render=t=>{!function(t,e){e.renderTarget=r.Collision,e.clear(0),e.renderTarget=r.Screen,e.clear(0)}(0,e),function(t,e){e.renderTarget=r.Collision;const{x:n,y:i,radius:s,color:o}=t.data.hero;e.fillCircle(n,i,s,o)}(t,e),t.blocks.each(t=>(function(t,e){e.renderTarget=r.Collision;const{x:n,y:i,angle:s,length:o,color:a}=t.data;let c=Math.cos(s)*o,h=Math.sin(s)*o;e.line(n,i,n+c,i+h,a)})(t,e)),function(t,e){e.renderSource=r.Collision,e.renderTarget=r.Screen,e.spr()}(0,e)}}function d(t,e){this.alive=[],this.dead=[],this.create=n=>{if(this.dead.length>0){let t=this.dead.pop();return t.init(n),this.alive.push(t),t}{let i=new t(e);return i.init(n),this.alive.push(i),i}},this.release=t=>{let e=this.alive.indexOf(t);e>-1&&this.dead.push(this.alive.splice(e,1)[0])},this.each=t=>{this.alive.forEach(t)},this.find=t=>this.alive.find(t)}function f(t,e){this.data=t;const{width:n,height:r}=this.data.game,s=this.data.hero;this.blocks=new d(p,this);const a=t=>{this.data.game.tick+=t},l=t=>{const n=this.blocks.find(t=>!(t.life<100)&&function(t,e,n){return n((n,i)=>t.pget(n,i,t.buffers.Collision)===e)}(e,i,function({x:t,y:e,angle:n,length:i}){return r=>{for(let s=0;s<i;s+=.1){const i=Math.cos(n)*s,o=Math.sin(n)*s;if(r(t+i,e+o))return!0}return!1}}(t.data)));if(n){const{angle:t}=n.data;(t=>{const e=[Math.cos(t),Math.sin(t)],n=[-s.vx,-s.vy],i=[n[0]+e[0],n[1]+e[1]];s.vx=h(2*i[0],-1,1),s.vy=h(2*i[1],-1,1)})(t),this.blocks.release(n)}},u=()=>{this.userBoost?(s.boost=10,this.userBoost=!1):s.boost=1},f=g(()=>{this.blocks.create({x:c(10,n-10),y:c(10,r-10),length:10,angle:c(0,o/4-o/8)+o/10})},1e3);this.boost=()=>{this.userBoost=!0},this.update=t=>{u(),f(t),l(),a(t),(t=>{s.x+=s.vx*s.boost,s.y+=s.vy*s.boost,s.x<0&&(s.x=0,s.vx*=-1),s.y<0&&(s.y=0,s.vy*=-1),s.x>=n&&(s.x=n,s.vx*=-1),s.y>=r&&(s.y=r,s.vy*=-1)})(),this.blocks.each(e=>e.update(t))}}function p(t){this.init=t=>{this.data={...e(),...t},this.life=0},this.update=t=>{this.life+=t};const e=()=>({x:0,y:0,angle:a,length:100,color:r})}const g=(t,e,n)=>{let i=0;return r=>{(i+=r)>=e?(t(),i=0):n&&n(i/e)}},v=void 0!==window.performance?window.performance:Date,y=()=>v.now(),b=window.requestAnimationFrame;function m(t){let e=!1,n=y(),i=0;this.start=()=>e?this:(e=!0,n=y(),i=b(r),this),this.stop=()=>(e=!1,0!=i&&b.cancel(i),i=0,this);const r=()=>{i=b(r);const e=y();t(e-n),n=e}}function w(t,e){const n=document.createElement("canvas"),r=n.getContext("2d"),s={game:{unit:40,width:256,height:256,ratio:1,vx:10,tick:0},hero:{color:i,radius:10,gap:2,gapMove:2,rotation:0,x:128,y:128,vx:0,vy:-1,boost:1,tick:0}};let o=new l(s,r),a=new f(s,o),c=new u(a,o);new m(t=>{a.update(t),c.render(a),o.render()}).start(),n.width=s.game.width,n.height=s.game.height,t.append(n),function(t){const e=[],n=function(t){return function(e){switch(e.code){case"Space":t.boost();break;default:return}e.preventDefault()}}(t);var i,r,s;e.push((i=document,r="keydown",s=n,i.addEventListener(r,s),()=>i.removeEventListener(r,s)))}(a)}n.d(e,"app",function(){return w})}]);