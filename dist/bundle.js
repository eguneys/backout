var Tetris=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){n(2);const i=n(3);t.exports=i.app},function(t,e,n){},function(t,e,n){"use strict";n.r(e);const i={Play:"play",Over:"over"},r=3,s=4,o=Math.PI,a=2*o,h=a/3;function l(t,e){return Math.random()*(e-t)+t}function c(t,e,n){return Math.min(Math.max(t,e),n)}function d(t,e){const{width:n,height:i}=t.game,r=n*i;this.buffers={Screen:0,Effects:r,Buffer:2*r,Background:3*r,Midground:4*r,Foreground:5*r,Sprites:7*r,Ui:8*r,Collision:9*r};const s=this.buffers,o=[4278715910,4279439380,4280620859,4281145203,4280950964,4280499935,4278872826,4280001529,4282504703,4282449151,4284805846,4282637212,4281712985,4281245716,4282284570,4282077732,4280295442,4284757012,4291058728,4292779812,4291286560,4292607142,4294967295,4290835454,4290303738,4288127221,4285754088,4288367292,4286593657,4283642688,4281606692,4279901218,4280822578,4282073457,4282873275,4284720347,4288467700,4293583066,4291934643,4289696651,4287460717,4284634186,4282464563,4281541698,4281872731,4283585166,4285167034,4288919017,4294960867,4294688697,4293172100,4290678104,4286938439,4283328291,4284777522,4287475549,4290436242,4293064653,4289385188,4287344839,4284647072,4283787129,4282666586,4281612610,4278190080];let a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64];this.renderTarget=s.Screen,this.renderSource=s.Page1;const h=e.getImageData(0,0,n,i);let l=new ArrayBuffer(h.data.length),d=new Uint8ClampedArray(l),u=new Uint32Array(l),f=new Uint8ClampedArray(n*i*22);this.clear=t=>{f.fill(t,this.renderTarget,this.renderTarget+r)},this.pset=(t,e,r)=>{t=c(0|t,0,n),e=c(0|e,0,i),f[this.renderTarget+e*n+t]=r},this.pget=(t,e,r)=>(t=c(0|t,0,n),e=c(0|e,0,i),f[r+e*n+t]),this.spr=(t=0,e=0,r=n,s=i,o=0,h=0,l=!1,c=!1)=>{for(let d=0;d<s;d++)for(let s=0;s<r;s++)if(h+d<i&&o+s<n&&h+d>-1&&o+s>-1&&!l&!c){let i=this.renderTarget+((h+d)*n+o+s),r=this.renderSource+((e+d)*n+t+s);f[r]>0&&(f[i]=a[f[r]])}},this.line=(t,e,n,i,r)=>{let s,o=(i|=0)-(e|=0),a=(n|=0)-(t|=0),h=1,l=1;if(o<0&&(o=-o,l=-1),a<0&&(a=-a,h=-1),o<<=1,a<<=1,this.pset(t,e,r),a>o)for(s=o-(a>>1);t!=n;)s>=0&&(e+=l,s-=a),t+=h,s+=o,this.pset(t,e,r);else for(s=a-(o>>1);e!=i;)s>=0&&(t+=h,s-=o),e+=l,s+=a,this.pset(t,e,r)},this.circle=(t,e,n,i)=>{let r=-n,s=0,o=2-2*n;do{this.pset(t-r,e+s,i),this.pset(t-s,e-r,i),this.pset(t+r,e-s,i),this.pset(t+s,e+r,i),(n=o)<=s&&(o+=2*++s+1),(n>r||o>s)&&(o+=2*++r+1)}while(r<0)},this.fillCircle=(t,e,n,i)=>{if(n<0)return;t|=0,e|=0,i|=0;let r=-(n|=0),s=0,o=2-2*n;do{this.line(t-r,e-s,t+r,e-s,i),this.line(t-r,e+s,t+r,e+s,i),(n=o)<=s&&(o+=2*++s+1),(n>r||o>s)&&(o+=2*++r+1)}while(r<0)},this.fillRect=(t,e,n,i,r)=>{let s=Math.abs(i-e);if(this.line(t,e,n,e,r),s>0)for(;--s;)this.line(t,e+s,n,e+s,r);this.line(t,i,n,i,r)},this.fr=(t,e,n,i,r)=>{let s=0|t,o=0|e,a=t+n|0,h=e+i|0,l=Math.abs(h-o);if(this.line(s,o,a,o,r),l>0)for(;--l;)this.line(s,o+l,a,o+l,r);this.line(s,h,a,h,r)};this.render=()=>{let t=s.Effects;for(;t--;)u[t]=o[a[f[t]]];h.data.set(d),e.putImageData(h,0,0)}}!function(){const t={"-":"\n\n\n.....\n\n\n"," ":"\n\n\n\n\n\n","/":"\n    .\n   .\n  .\n .\n.\n",x:"\n.   .\n . .\n  .\n . .\n.   .\n",unknown:"\n.....\n.   .\n.   .\n.   .\n.....\n"};Object.keys(t).reduce((e,n)=>({[n]:t[n].replace(/^\n|\n$/g,"").split("\n").map(t=>t.split("")),...e}),{})}();function u(t,e){const{width:n,height:i}=t.data.game,r=e.buffers;e.renderTarget=r.Screen,this.render=t=>{!function(t,e){e.renderTarget=r.Collision,e.clear(0),e.renderTarget=r.Screen,e.clear(0)}(0,e),function(t,e){(t=t.play).data.paddles.forEach(t=>(function(t,e,n){n.renderTarget=r.Collision;const{x:i,y:s,w:o,h:a}=e;n.fillRect(i,s,i+o,s+a,5)})(0,t,e)),t.blocks.each(t=>(function(t,e){e.renderTarget=r.Collision;const{x:n,y:i,angle:s,length:o,color:a}=t.data;let h=Math.cos(s)*o,l=Math.sin(s)*o;e.line(n,i,n+h,i+l,a)})(t,e)),function(t,e){e.renderTarget=r.Collision;const{x:n,y:i,radius:s,color:o}=t.data.hero;e.fillCircle(n,i,s,o)}(t,e)}(t,e),function(t,e){e.renderSource=r.Collision,e.renderTarget=r.Screen,e.spr()}(0,e)}}function f(t,e){this.alive=[],this.dead=[],this.create=n=>{if(this.dead.length>0){let t=this.dead.pop();return t.init(n),this.alive.push(t),t}{let i=new t(e);return i.init(n),this.alive.push(i),i}},this.release=t=>{let e=this.alive.indexOf(t);e>-1&&this.dead.push(this.alive.splice(e,1)[0])},this.each=t=>{this.alive.forEach(t)},this.find=t=>this.alive.find(t)}function p(t){const{width:e,height:n}=t.data.game,i=t.data.hero;this.update=t=>{i.x+=i.vx*i.boost,i.y+=i.vy*i.boost,i.x<0&&(i.x=0,i.vx*=-1),i.y<0&&(i.y=0,i.vy*=-1),i.x>=e&&(i.x=e,i.vx*=-1),i.y>=n&&(i.y=n,i.vy*=-1)},this.boost=t=>{i.boost=t},this.changeV=t=>{const e=[Math.cos(t),Math.sin(t)],n=[-i.vx,-i.vy],r=[n[0]+e[0],n[1]+e[1]];i.vx=c(2*r[0],-1,1),i.vy=c(2*r[1],-1,1)}}function y(t,e,n){return n((n,i)=>t.pget(n,i,t.buffers.Collision)===e)}function g(t,e){const{width:n,height:i}=t.data.game,s=t.data.paddles;this.update=o=>{(n=>{s.find(t=>y(e,r,function({x:t,y:e,w:n,h:i}){return r=>{for(let s=0;s<n;s+=1)for(let n=0;n<i;n+=1)if(r(t+s,e+n))return!0;return!1}}(t)))&&t.paddleHit()})(),s.forEach(t=>(t=>e=>{t.x+=t.vx,t.y+=t.vy,t.x>n-t.w&&(t.x=n-t.w,t.vx*=-1),t.x<0&&(t.x=0,t.vx*=-1),t.y>i-t.h&&(t.y=i-t.h,t.vy*=-1),t.y<0&&(t.y=0,t.vy*=-1)})(t)(o))}}function v(t,e){this.data=t;const{width:n,height:s}=this.data.game;this.hero=new p(this),this.paddles=new g(this,e),this.blocks=new f(x,this);const o=t=>{const n=this.blocks.find(t=>!(t.life<100)&&y(e,r,function({x:t,y:e,angle:n,length:i}){return r=>{for(let s=0;s<i;s+=.1){const i=Math.cos(n)*s,o=Math.sin(n)*s;if(r(t+i,e+o))return!0}return!1}}(t.data)));if(n){const{angle:t}=n.data;this.hero.changeV(t),this.blocks.release(n)}},h=()=>{this.userBoost?(this.hero.boost(10),this.userBoost=!1):this.hero.boost(1)},c=w(()=>{this.blocks.create({x:l(10,n-10),y:l(10,s-10),length:10,angle:l(0,a/4-a/8)+a/10})},1e3);this.boost=()=>{this.userBoost=!0},this.paddleHit=()=>{this.data.state=i.Over},this.update=t=>{h(),c(t),o(),this.hero.update(t),this.paddles.update(t),this.blocks.each(e=>e.update(t))}}function x(t){this.init=t=>{this.data={...e(),...t},this.life=0},this.update=t=>{this.life+=t};const e=()=>({x:0,y:0,angle:h,length:100,color:s})}const w=(t,e,n)=>{let i=0;return r=>{(i+=r)>=e?(t(),i=0):n&&n(i/e)}};function b(t,e){this.data=t,this.play=new v(t,e);const n=t=>{this.data.state===i.Play&&this.play.update(t)},r=t=>{this.data.state===i.Over&&this.over.update(t)};this.update=t=>{n(t),r(t)}}const m=void 0!==window.performance?window.performance:Date,M=()=>m.now(),S=window.requestAnimationFrame;function T(t){let e=!1,n=M(),i=0;this.start=()=>e?this:(e=!0,n=M(),i=S(r),this),this.stop=()=>(e=!1,0!=i&&S.cancel(i),i=0,this);const r=()=>{i=S(r);const e=M();t(e-n),n=e}}function k(t,e){const n=document.createElement("canvas"),s=n.getContext("2d"),o={state:i.Play,game:{unit:40,width:384,height:256,ratio:256/384,vx:10,tick:0},paddles:[{vx:1,vy:0,x:192,y:0,w:40,h:10},{vx:-1,vy:0,x:192,y:246,w:40,h:10},{vx:0,vy:1,x:0,y:128,w:10,h:40},{vx:0,vy:-1,x:373,y:128,w:10,h:40}],hero:{color:r,radius:10,gap:2,gapMove:2,rotation:0,x:192,y:128,vx:0,vy:-1,boost:1,tick:0}};let a=new d(o,s),h=new b(o,a),l=new u(h,a);new T(t=>{h.update(t),l.render(h),a.render()}).start(),n.width=o.game.width,n.height=o.game.height,t.append(n),function(t){const e=[],n=function(t){return function(e){switch(e.code){case"Space":t.play.boost();break;default:return}e.preventDefault()}}(t);var i,r,s;e.push((i=document,r="keydown",s=n,i.addEventListener(r,s),()=>i.removeEventListener(r,s)))}(h)}n.d(e,"app",function(){return k})}]);